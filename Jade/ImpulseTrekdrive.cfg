// Patch by Caliperstorm to add TrekDrive functionality to Impulse Party parts

// Impulse Engines
@PART[impp_impeng*]:NEEDS[ImpulseParty,TrekDrive,!FlyingSaucers]
{
	-MODULE[ModuleEnginesFX] {}
	-MODULE[ModuleGimbal] {}
	
	MODULE
	{
		name = SW_ModuleImpulseEngine
		maxAccel = 2.0
		maxAccel *= #$/refPower$
		maxVerticalAccel = 1.0
		hoverAlt = 2000
		engineEfficiency = 0.80
		minDeuterium = 0.1
		ecProd = 2500
		maxVectorAngle = 35
		engineSFX = TrekDrive/Sounds/tng_engine_hum_short
	
		PROPELLANT
		{
			name = LqdDeuterium
			ratio = 1
			drawGauge = True
		}	
	}
}

// Warp Cores
@PART[impp_coreS?|impp_coreMk2]:NEEDS[ImpulseParty,TrekDrive,!FlyingSaucers]
{
	-MODULE[ModuleResourceConverter],* {}
	-RESOURCE[FusionPellets] {}
	-RESOURCE[ElectroPlasma] {}
	
	MODULE
	{
		name = SW_ModuleWarpCore
		ambientSoundPath = TrekDrive/Sounds/tng_warp_core_hum
		minAntimatter = 0.1
		minMatter = 0.1
		warpPlasmaProdRate = 50
		warpPlasmaProdRate *= #$/refCapacity$
		ecProdRate = 2500
		ecProdRate  *= #$/refCapacity$
	}

	MODULE
	{
		name = SW_ModuleWarpGenerator
		engineID = JadeWarp
		maxWarp = 5
		minNacelles = 2
		electricityReq = 1000.0
	}
	
	RESOURCE
	{
		name = ElectricCharge
		amount = 1000
		amount *= #$/refCapacity$
		maxAmount = 1000
		maxAmount *= #$/refCapacity$
	}

	RESOURCE
	{
		name = LqdDeuterium
		amount = 8000
		amount *= #$/refCapacity$
		maxAmount = 8000
		maxAmount *= #$/refCapacity$
	}

	RESOURCE
	{
		name = Antimatter
		amount = 8000
		amount *= #$/refCapacity$
		maxAmount = 8000
		maxAmount *= #$/refCapacity$
	}
	
	MODULE:NEEDS[Waterfall]
	{
		name = ModuleWaterfallFX
		moduleID = ConstitutionWarpFX
		engineID = JadeWarp
	
		CONTROLLER
		{
			name = throttle
			linkedTo = throttle
		}
	
		TEMPLATE
		{
			templateName = TrekDriveWarpStars
			scale = 2,2,2
			rotation = 0,0,0
			position = 0,0,0
		}
	}
}

// Warp Coils
@PART[impp_nac*]:NEEDS[ImpulseParty,TrekDrive,!FlyingSaucers]
{
	@entryCost = #$cost$
	@entryCost *= 10
	@TechHidden = False
	@category = Engine
}

// S2
@PART[impp_nacLowerS2|impp_nacTailS2]:NEEDS[ImpulseParty,TrekDrive,!FlyingSaucers]
{
	MODULE
	{
		name = SW_ModuleWarpCoil
		minWarpPlasma = 400
		warpPlasmaConsumed = 8
		warpPlasmaNeeded = 250
		cutoffThreshold = 2.000
		coilEfficiency = 0.85
		maxWarp = 5
	}
	
	RESOURCE
	{
		name = WarpPlasma
		amount = 0
		maxAmount = 2000
	}
}

// MK2
@PART[impp_nacLowerMk2|impp_nacTailMk2]:NEEDS[ImpulseParty,TrekDrive,!FlyingSaucers]
{
	MODULE
	{
		name = SW_ModuleWarpCoil
		minWarpPlasma = 400
		warpPlasmaConsumed = 7
		warpPlasmaNeeded = 250
		cutoffThreshold = 2.000
		coilEfficiency = 0.85
		maxWarp = 4
	}
	
	RESOURCE
	{
		name = WarpPlasma
		amount = 0
		maxAmount = 1500
	}
}

// S1
@PART[impp_nacSeg|impp_nacSeg|impp_nacUpper]:NEEDS[ImpulseParty,TrekDrive,!FlyingSaucers]
{
	MODULE
	{
		name = SW_ModuleWarpCoil
		minWarpPlasma = 400
		warpPlasmaConsumed = 6
		warpPlasmaNeeded = 250
		cutoffThreshold = 2.000
		coilEfficiency = 0.85
		maxWarp = 3
	}
	
	RESOURCE
	{
		name = WarpPlasma
		amount = 0
		maxAmount = 1000
	}
}

// S0
@PART[impp_nacSegS0|impp_nacTailS0]:NEEDS[ImpulseParty,TrekDrive,!FlyingSaucers]
{
	MODULE
	{
		name = SW_ModuleWarpCoil
		minWarpPlasma = 400
		warpPlasmaConsumed = 5
		warpPlasmaNeeded = 250
		cutoffThreshold = 2.000
		coilEfficiency = 0.85
		maxWarp = 2
	}
	
	RESOURCE
	{
		name = WarpPlasma
		amount = 0
		maxAmount = 500
	}
}

// Bussard Collectors
@PART[impp_scoop*]:NEEDS[ImpulseParty,TrekDrive,!FlyingSaucers]
{
	MODULE
	{
		name = SW_ModuleBussardCollector
		collectionRadius = 15
		collectorEfficiency = #$/refCapacity$
	}
}