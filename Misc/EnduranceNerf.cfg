// Author: Caliperstorm

// Patch to seriously nerf all engines from KSP Endurance
// I understand why Jade buffed these so much in the revamp, but the stats on all these are incredibly unrealistic and overpowerered compared to FFT or Sterling
// Main complaints are that the Endurance main engines have 500,000s ISP, which is closer to pure fusion engines instead of the MDP drives they are supposed to be;
// And that the Ranger engine has 15000s, which is almost as good as the FFT discovery drive.
// Now I've nerfed the Ranger and Lander engine ISPs down to near the FFT fusion aerospike, and the Endurance to about VASMIR-level

// Also forces LqdH2 fuel to simplify power math and buffs fusion reactors to compensate for increased engine EC use
// NOTE: INCOMPATABLE WITH DSEV unless I add support for ModuleFusionReactor

// Ranger body and engine
@PART[ENrangerBody]:FINAL
{
	@MODULE[ModuleResourceConverter]:HAS[#ConverterName[Tokamak?Reactor]]
	{
		OUTPUT_RESOURCE:HAS[#ResourceName[ElectricCharge]]
		{
			@Ratio = 3500
		}
	}
}
@PART[ENrangerEngine]:FINAL
{
	@MODULE[ModuleEnginesFX]
	{
		@PROPELLANT[LiquidFuel]
		{
			@name = LqdHydrogen
		}
		@PROPELLANT[ElectricCharge]
		{
			@ratio = 12.73798808
		}
		@atmosphereCurve
		{
			-key,* = 0
			key = 0 2200
			key = 1 2000
			key = 11 0.01 -500 0
		}
	}
}

// Lander body and lifting engine
@PART[ENlanderBody]:FINAL
{
	@MODULE[ModuleEnginesFX]
	{
		@PROPELLANT[LiquidFuel]
		{
			@name = LqdHydrogen
		}
		@PROPELLANT[ElectricCharge]
		{
			@ratio = 16.67528223
		}
		@atmosphereCurve
		{
			-key,* = 0
			key = 0 2400
			key = 1 2100
			key = 11 0.01 -500 0
		}
	}
	@MODULE[ModuleResourceConverter]:HAS[#ConverterName[Tokamak?Reactor]]
	{
		OUTPUT_RESOURCE:HAS[#ResourceName[ElectricCharge]]
		{
			@Ratio = 8000
		}
	}
}
@PART[ENlanderVTOL]:FINAL
{
	@MODULE[ModuleEnginesFX]
	{
		@PROPELLANT[LiquidFuel]
		{
			@name = LqdHydrogen
		}
		@PROPELLANT[ElectricCharge]
		{
			@ratio = 16.67528223
		}
		@atmosphereCurve
		{
			-key,* = 0
			key = 0 2400
			key = 1 2100
			key = 11 0.01 -500 0
		}
	}
}

// Miniranger/Viper
@PART[ENminiRanger]:FINAL
{
	@MODULE[ModuleEnginesFX]
	{
		@PROPELLANT[LiquidFuel]
		{
			@name = LqdHydrogen
		}
		@PROPELLANT[ElectricCharge]
		{
			@ratio = 16.675
		}
		@atmosphereCurve
		{
			-key,* = 0
			key = 0 2400
		}
	}
	@MODULE[ModuleResourceConverter]:HAS[#ConverterName[Tokamak?Reactor]]
	{
		OUTPUT_RESOURCE:HAS[#ResourceName[ElectricCharge]]
		{
			@Ratio = 1000
		}
	}
}

// Endurance engine mount and main engine
@PART[ENmountEndurance]:FINAL
{
	@MODULE[ModuleResourceConverter]:HAS[#ConverterName[Tokamak?Reactor]]
	{
		OUTPUT_RESOURCE:HAS[#ResourceName[ElectricCharge]]
		{
			@Ratio = 10000
		}
	}
}
@PART[ENenduranceEngine]:FINAL
{
	@MODULE[ModuleEnginesFX],0
	{
		@PROPELLANT[LiquidFuel]
		{
			@name = LqdHydrogen
		}
		@PROPELLANT[ElectricCharge]
		{
			@ratio = 148.88485
		}
		@atmosphereCurve
		{
			-key,* = 0
			key = 0 15000
			key = 1 3750
			key = 1.15 0.01
		}
	}	
	@MODULE[ModuleEnginesFX],1
	{
		@PROPELLANT[LiquidFuel]
		{
			@name = LqdHydrogen
		}
		@PROPELLANT[ElectricCharge]
		{
			@ratio = 37.22149
		}
		@atmosphereCurve
		{
			-key,* = 0
			key = 0 7500
			key = 1 1875
			key = 1.5 0.01
		}
	}
}

// RCS
@PART[ENmountEndurance|ENcargoScience|ENrangerBody|ENlanderBody|ENminiRanger]:FINAL
{
	@MODULE[ModuleRCSFX]
	{
		@resourceName = LqdHydrogen
		@PROPELLANT[LiquidFuel]
		{
			@name = LqdHydrogen
		}
		@PROPELLANT[ElectricCharge]
		{
			@ratio = 5.211
		}
	}
}